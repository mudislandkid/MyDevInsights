# ====================
# MyDevInsights Configuration
# ====================

# REQUIRED: Anthropic API Key for Claude AI
# Get your API key at: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-your-api-key-here

# REQUIRED: Path to your projects directory (host machine path)
# This directory will be mounted read-only in Docker containers
# Examples:
#   macOS/Linux: /Users/yourname/Projects or /home/yourname/Projects
#   Windows: C:\Users\yourname\Projects (use forward slashes: C:/Users/yourname/Projects)
PROJECTS_PATH=/path/to/your/projects

# ====================
# Database Configuration
# ====================

# PostgreSQL credentials
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=mydevinsights
POSTGRES_PORT=5432

# PostgreSQL connection string (auto-constructed from above variables)
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/mydevinsights

# ====================
# Redis Configuration
# ====================

# Redis port
REDIS_PORT=6379

# Redis connection string
# Format: redis://host:port or redis://host:port/db
REDIS_URL=redis://redis:6379

# ====================
# Backend Configuration
# ====================

# Port for the backend API server
BACKEND_PORT=3000

# Node environment (development, production, test)
NODE_ENV=development

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# ====================
# Worker Configuration
# ====================

# Number of concurrent analysis jobs to process
# IMPORTANT: Set to 1 for Anthropic free tier (30k tokens/min limit)
# With ~18k tokens per request, only 1-2 requests fit in the rate limit window
WORKER_CONCURRENCY=1

# AI analysis timeout in milliseconds (default: 180000 = 3 minutes)
# Increase for very large projects (1M+ LOC)
AI_TIMEOUT_MS=180000

# Maximum tokens for AI analysis output (default: 4096)
AI_MAX_TOKENS=4096

# AI temperature for analysis (0.0-1.0, default: 0.7)
# Lower = more deterministic, Higher = more creative
AI_TEMPERATURE=0.7

# Maximum tokens of project context to send (default: 8000)
# IMPORTANT: Lower this to avoid rate limits with free tier
# With 30k tokens/min limit, max ~8k context + system prompt fits better
MAX_CONTEXT_TOKENS=8000

# Rate Limiter Configuration
# IMPORTANT: These settings prevent hitting API rate limits
RATE_LIMIT_CONCURRENT=1          # Max concurrent API requests (1 for free tier)
RATE_LIMIT_PER_MIN=2             # Max requests per minute (2 for 30k token/min limit)
MAX_RETRIES=3                    # Number of retry attempts
BACKOFF_MULTIPLIER=2             # Exponential backoff multiplier
INITIAL_DELAY_MS=5000            # Initial retry delay (5 seconds)

# ====================
# File Watcher Configuration
# ====================

# Container path for file watcher (usually /projects)
WATCH_PATH=/projects

# Delay before starting file watcher (milliseconds)
# Gives time for backend to fully initialize
STARTUP_DELAY=5000

# Debounce delay for file system events (milliseconds)
DEBOUNCE_DELAY=2000

# Ignored directories (comma-separated)
IGNORE_PATTERNS=node_modules,.git,dist,build,.next

# ====================
# Optional: Additional AI Providers
# ====================

# Perplexity API for research-enhanced analysis (optional)
# PERPLEXITY_API_KEY=pplx-your-api-key-here

# OpenAI API for alternative AI provider (optional)
# OPENAI_API_KEY=sk-your-openai-key-here

# ====================
# Frontend Configuration
# ====================

# Frontend development server port
FRONTEND_PORT=5173

# Backend API URL (for frontend to connect to)
VITE_API_URL=http://localhost:3000

# WebSocket URL (for real-time updates)
VITE_WS_URL=ws://localhost:3000/ws

# ====================
# Production Configuration
# ====================
# Uncomment and configure these for production deployment

# CORS allowed origins (comma-separated)
# CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# Rate limiting (requests per window)
# RATE_LIMIT_MAX=100
# RATE_LIMIT_WINDOW_MS=60000

# Session secret for authentication (if implementing auth)
# SESSION_SECRET=your-random-secret-here

# Enable SSL/TLS
# SSL_ENABLED=true
# SSL_KEY_PATH=/path/to/ssl/key.pem
# SSL_CERT_PATH=/path/to/ssl/cert.pem
